window.__require=function e(t,n,i){function s(o,a){if(!n[o]){if(!t[o]){var r=o.split("/");if(r=r[r.length-1],!t[r]){var p="function"==typeof __require&&__require;if(!a&&p)return p(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+o+"'")}}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return s(t[o][1][e]||e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var c="function"==typeof __require&&__require,o=0;o<i.length;o++)s(i[o]);return s}({CollisionProxy:[function(e,t,n){"use strict";function i(e){this.realListener.onCollisionEnter(e)}function s(e){this.realListener.onCollisionStay(e)}function c(e){this.realListener.onCollisionExit(e)}cc._RF.push(t,"6cd7aG5qipG8Z9+eOwNmn3m","CollisionProxy"),cc.Class({extends:cc.Component,properties:{realListener:cc.Component},onLoad:function(){this.onCollisionEnter=null,this.onCollisionStay=null,this.onCollisionExit=null,this.realListener&&(this.realListener.onCollisionEnter&&(this.onCollisionEnter=i),this.realListener.onCollisionStay&&(this.onCollisionStay=s),this.realListener.onCollisionExit&&(this.onCollisionExit=c))}}),cc._RF.pop()},{}],DrillerManager:[function(e,t,n){"use strict";cc._RF.push(t,"9d752VBYEJPOqiPJAYcWU+2","DrillerManager");var i=e("Driller");cc.Class({extends:cc.Component,properties:{prefab:cc.Prefab,spawnInterval:1},onLoad:function(){D.drillerManager=this},start:function(){this.schedule(this.spawn,this.spawnInterval)},spawn:function(){D.sceneManager.spawn(this.prefab,i)},reset:function(){this.unschedule(this.spawn)}}),cc._RF.pop()},{Driller:"Driller"}],Driller:[function(e,t,n){"use strict";function i(e){var t=-e.rotation;return new cc.Vec2(0,-1).rotateSelf(t*Math.PI/180)}cc._RF.push(t,"4c008xCm+xJSLzvNSxTP2bJ","Driller"),cc.Class({extends:e("SceneObject"),properties:{velocity:{default:5},angleVelocity:5},onEnable:function(){this.node.y=0},update:function(e){var t=D.sheep.node.position,n=this.node.position,s=t.sub(n).normalizeSelf();i(this.node).cross(s)>0?this.node.rotation+=this.angleVelocity*e:this.node.rotation-=this.angleVelocity*e;var c=i(this.node).mul(this.velocity*e);this.node.position=n.add(c)},onCollisionEnter:function(){D.sceneManager.despawn(this)}}),cc._RF.pop()},{SceneObject:"SceneObject"}],Dust:[function(e,t,n){"use strict";cc._RF.push(t,"97ca5Hx+7VEy425oaf76L9U","Dust"),cc.Class({extends:e("SceneObject"),properties:{anim:cc.Animation},playAnim:function(e){this.anim.play(e)},finish:function(){this.node.removeFromParent(),D.sceneManager.putIntoPool(this)}}),cc._RF.pop()},{SceneObject:"SceneObject"}],GameManager:[function(e,t,n){"use strict";cc._RF.push(t,"327f03mWlNHJqsi+VEpOBXC","GameManager");var i=e("Sheep"),s=(e("Scroller"),cc.Enum({Menu:-1,Run:-1,Over:-1})),c=cc.Class({extends:cc.Component,properties:{sheep:i,gameOverMenu:cc.Node,scoreText:cc.Label,gameBgAudio:{default:null,type:cc.AudioClip},dieAudio:{default:null,type:cc.AudioClip},gameOverAudio:{default:null,type:cc.AudioClip},scoreAudio:{default:null,type:cc.AudioClip},supermanMode:{default:!1,tooltip:"\u65e0\u654c\u6a21\u5f0f, \u65b9\u4fbf\u6d4b\u8bd5\u5730\u56fe"}},statics:{State:s},onLoad:function(){D.GameManager=c,D.game=this,cc.director.getCollisionManager().enabled=!0,this.state=s.Menu,this.score=0,this.scoreText.string=this.score,this.gameOverMenu.active=!1,this.sheep.init()},start:function(){this.state=s.Run,this.score=0,cc.audioEngine.playMusic(this.gameBgAudio),D.pipeManager.startSpawn(),D.starManager.start(),D.drillerManager.start(),this.sheep.startRun()},gameOver:function(){cc.audioEngine.stopMusic(),cc.audioEngine.playEffect(this.dieAudio),cc.audioEngine.playEffect(this.gameOverAudio),D.pipeManager.reset(),D.starManager.reset(),D.drillerManager.reset(),this.state=s.Over,this.gameOverMenu.active=!0,this.gameOverMenu.getComponent("GameOverMenu").score.string=this.score},gainScore:function(){this.score++,this.scoreText.string=this.score,cc.audioEngine.playEffect(this.scoreAudio)}});cc._RF.pop()},{Scroller:"Scroller",Sheep:"Sheep"}],GameOverMenu:[function(e,t,n){"use strict";cc._RF.push(t,"42ba7gAyfpGZqXEsckB6M2a","GameOverMenu");cc.Class({extends:cc.Component,properties:{btn_play:cc.Button,score:cc.Label},restart:function(){cc.director.loadScene("Game")}});cc._RF.pop()},{}],Globals:[function(e,t,n){"use strict";cc._RF.push(t,"67384+vJYpFIbOgxpXpv1wf","Globals"),window.D={GameManager:null,game:null,pipeManager:null,sceneManager:null,starManager:null,drillerManager:null,sheep:null},cc._RF.pop()},{}],PipeGroupManager:[function(e,t,n){"use strict";cc._RF.push(t,"ded04ocxo1Pcopg6kafVPGn","PipeGroupManager");var i=e("PipeGroup");cc.Class({extends:cc.Component,properties:{pipePrefab:cc.Prefab,spawnInterval:0},onLoad:function(){D.pipeManager=this},startSpawn:function(){this.spawnPipe(),this.schedule(this.spawnPipe,this.spawnInterval)},spawnPipe:function(){D.sceneManager.spawn(this.pipePrefab,i)},reset:function(){this.unschedule(this.spawnPipe)}}),cc._RF.pop()},{PipeGroup:"PipeGroup"}],PipeGroup:[function(e,t,n){"use strict";cc._RF.push(t,"5026dczn8lKZpq2Z+LGadpZ","PipeGroup"),cc.Class({extends:e("SceneObject"),properties:{botYRange:cc.v2(0,0),spacingRange:cc.v2(0,0),topPipe:cc.Node,botPipe:cc.Node},onEnable:function(){var e=this.botYRange.x+Math.random()*(this.botYRange.y-this.botYRange.x),t=e+(this.spacingRange.x+Math.random()*(this.spacingRange.y-this.spacingRange.x));this.topPipe.y=t,this.botPipe.y=e}}),cc._RF.pop()},{SceneObject:"SceneObject"}],SceneManager:[function(e,t,n){"use strict";cc._RF.push(t,"7f551XdVyJL2LKjMUkRRfqD","SceneManager");var i=e("SceneObject");cc.Class({extends:cc.Component,properties:{spawnX:0,objectSpeed:0,_pool:null},onLoad:function(){D.sceneManager=this,this._pool=new cc.js.Pool(function(e){console.log("clear obj success")},10),this._pool.get=this.getCompObj},spawn:function(e,t,n){var i=this._pool.get(t);return i||(i=cc.instantiate(e).getComponent(t)),n?i.node.parent=n:(this.node.addChild(i.node),i.node.x=this.spawnX),i.node.active=!0,i},despawn:function(e){e.node.removeFromParent(),e.node.active=!1,this.putIntoPool(e)},update:function(e){if(D.game.state===D.GameManager.State.Run)for(var t=this.objectSpeed*e,n=this.node.children,s=0;s<n.length;s++){var c=n[s];c.x+=t,c.getBoundingBoxToWorld().xMax<0&&this.despawn(c.getComponent(i))}},getCompObj:function(e){for(var t=this,n=0;n<this._pool.count;n++){var i=[],s=this._pool._get;if(s instanceof e)return i.forEach(function(e){t._pool.put(e)}),s;i.push(s)}return null},putIntoPool:function(e){var t=this._pool.count;return this._pool.put(e),t<this._pool.count||(console.warn("pool has been filled, please resize the array length."),!1)}}),cc._RF.pop()},{SceneObject:"SceneObject"}],SceneObject:[function(e,t,n){"use strict";cc._RF.push(t,"dbc2aqztmVGLq98q0UgDmUN","SceneObject"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){}}),cc._RF.pop()},{}],Scroller:[function(e,t,n){"use strict";cc._RF.push(t,"b90489JvD1O1pgXMQXSKGr7","Scroller"),cc.Class({extends:cc.Component,properties:{speed:0,resetX:0},update:function(e){if(D.game.state===D.GameManager.State.Run){var t=this.node.x;(t+=this.speed*e)<=this.resetX&&(t-=this.resetX),this.node.x=t}}}),cc._RF.pop()},{}],Sheep:[function(e,t,n){"use strict";cc._RF.push(t,"ff4b8pGzIRNxZt3wHXtOqB+","Sheep");var i=cc.Enum({None:-1,Run:-1,Jump:-1,Drop:-1,DropEnd:-1,Dead:-1}),s=cc.Class({extends:cc.Component,properties:{maxY:0,groundY:0,gravity:0,initJumpSpeed:0,_state:{default:i.None,type:i,visible:!1},state:{get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,this._state!==i.None&&this._updateAnimation())},type:i},jumpAudio:{default:null,type:cc.AudioClip},dustPrefab:cc.Prefab,addEnergyOnGround:{default:.5,tooltip:"\u6bcf\u79d2\u5728\u5730\u4e0a\u6062\u590d\u7684\u80fd\u91cf\u503c"},jumpEnergyCost:{default:.3,tooltip:"\u6bcf\u6b21\u8df3\u8dc3\u6d88\u8017\u7684\u80fd\u91cf\u503c"},energyBar:cc.ProgressBar,invincible:!1,invincibleTime:3,invincibleSpeed:-600,normalSpeed:-300},statics:{State:i},init:function(){var e=this;D.sheep=this,this.anim=this.getComponent(cc.Animation),this.currentSpeed=0,this.sprite=this.getComponent(cc.Sprite),this.registerInput(),this.energy=1,this._bindedScheduleFunc=function(){e.exitInvincible()}},startRun:function(){this.energy=1,this.state=i.Run,this.enableInput(!0)},registerInput:function(){var e=this;cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(){e.jump()},this.node),cc.find("Canvas").on(cc.Node.EventType.TOUCH_START,function(){e.jump()},this.node)},cancelListener:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN),cc.find("Canvas").off(cc.Node.EventType.TOUCH_START)},enableInput:function(e){e?this.registerInput():this.cancelListener()},update:function(e){switch(this.state){case i.Jump:this.currentSpeed<0&&(this.state=i.Drop);break;case i.Drop:this.node.y<this.groundY&&(this.node.y=this.groundY,this.state=i.DropEnd,this.spawnDust("DustDown"));break;case i.None:case i.Dead:return}this.state===i.Jump||this.node.y>this.groundY?(this.currentSpeed-=e*this.gravity,this.node.y+=e*this.currentSpeed):this.energy+=this.addEnergyOnGround*e,this.energy=cc.misc.clamp01(this.energy),this.energyBar.progress=this.energy},_updateAnimation:function(){var e=i[this._state];if(this.invincible){var t=e+"_invincible";e=this.anim.getAnimationState(t)?t:"Run_invincible"}this.anim.stop(),this.anim.play(e)},onDropFinished:function(){this.state=i.Run},onCollisionEnter:function(e){if(this.state!==i.Dead)switch(cc.game.groupList[e.node.groupIndex]){case"Obstacle":case"Driller":if(D.game.supermanMode)return;if(this.invincible)return;this.state=s.State.Dead,D.game.gameOver(),this.enableInput(!1);break;case"NextPipe":D.game.gainScore();break;case"Prop":this.enterInvincible()}},enterInvincible:function(){this.invincible=!0,this._updateAnimation(),this.unschedule(this._bindedScheduleFunc);var e=this.invincibleSpeed/this.normalSpeed;this.scheduleOnce(this._bindedScheduleFunc,this.invincibleTime*e),D.sceneManager.objectSpeed=this.invincibleSpeed,cc.director.getScheduler().setTimeScale(e)},exitInvincible:function(){D.sceneManager.objectSpeed=this.normalSpeed,this.invincible=!1,this._updateAnimation(),cc.director.getScheduler().setTimeScale(1)},jump:function(){this.energy>=this.jumpEnergyCost?(this.energy-=this.jumpEnergyCost,this.state=i.Jump,this.currentSpeed=this.initJumpSpeed,this.spawnDust("DustUp"),cc.audioEngine.playEffect(this.jumpAudio)):cc.audioEngine.playEffect(D.game.dieAudio)},spawnDust:function(e){var t=D.sceneManager.spawn(this.dustPrefab,"Dust",this.node);t.node.position=cc.v2(0,0),t.playAnim(e)}});cc._RF.pop()},{}],StarManager:[function(e,t,n){"use strict";cc._RF.push(t,"a3540dMSbNA0IxpobUt8I4j","StarManager");var i=e("Star");cc.Class({extends:cc.Component,properties:{starPrefab:cc.Prefab,spawnInterval:2,probableValue:{default:.1,tooltip:"\u751f\u6210\u661f\u661f\u7684\u6982\u7387"}},onLoad:function(){D.starManager=this},start:function(){this.schedule(this.spawn,this.spawnInterval,cc.macro.REPEAT_FOREVER,this.spawnInterval/2)},spawn:function(){Math.random()>this.probableValue||(D.sceneManager.spawn(this.starPrefab,i).node.y=595*Math.random()-270)},reset:function(){this.unschedule(this.spawn)}}),cc._RF.pop()},{Star:"Star"}],Star:[function(e,t,n){"use strict";cc._RF.push(t,"80271xjFbZOg5XRmHf6EPDi","Star"),cc.Class({extends:e("SceneObject")}),cc._RF.pop()},{SceneObject:"SceneObject"}]},{},["Driller","DrillerManager","Dust","GameManager","GameOverMenu","Globals","PipeGroup","PipeGroupManager","SceneManager","SceneObject","Scroller","Sheep","Star","StarManager","CollisionProxy"]);